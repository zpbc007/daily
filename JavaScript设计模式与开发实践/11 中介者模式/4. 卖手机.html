<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    选择颜色: 
    <select id="colorSelect">
        <option value="">请选择</option>
        <option value="red">红色</option>
        <option value="blue">蓝色</option>
    </select>

    选择内存:
    <select id="memorySelect">
        <option value="">请选择</option>
        <option value="32G">32G</option>
        <option value="16G">16G</option>
    </select>

    输入购买数量: <input type="text" id="numberInput"/><br/>

    选择了颜色: <div id="colorInfo"></div><br/>
    选择了内存: <div id="memoryInfo"></div>
    输入了数量: <div id="numberInfo"></div><br/>

    <button id="nextBtn" disabled="true">选择颜色和数量</button>
</body>
<script>
    // 每个节点对象都是耦合在一起的 更改添加删除都要通知到与其相关的对象
    var colorSelect = document.getElementById('colorSelect')
        numberInput = document.getElementById('numberInput')
        memorySelect = document.getElementById('memorySelect')
        colorInfo = document.getElementById('colorInfo')
        numberInfo = document.getElementById('numberInfo')
        memoryInfo = document.getElementById('memoryInfo')
        nextBtn = document.getElementById('nextBtn')
    
    var goods = {
        "red|32G": 3,
        "red|16G": 0,
        "blue|32G": 1,
        "blue|16G": 6
    }
    
    colorSelect.onchange = function (){
        var color = this.value
            memory = memorySelect.value
            number = numberInput.value
            stock = goods[color + '|' + memory]
        
        colorInfo.innerHTML = color

        if (!color) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '请选择颜色'
            return
        }         

        if (!memory) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '请选择内存大小'
            return
        }
        
        if(((number - 0) | 0) !== number - 0) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '请输入正确的数量'
            return
        }

        if(number > stock) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '库存不足'
            return
        }

        nextBtn.disabled = false
        nextBtn.innerHTML = '放入购物车'
    }

    memorySelect.onchange = function (){
        var color = colorSelect.value
            memory = this.value
            number = numberInput.value
            stock = goods[color + '|' + memory]
        
        memoryInfo.innerHTML = color

        if (!color) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '请选择颜色'
            return
        }         

        if (!memory) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '请选择内存大小'
            return
        }
        
        if(((number - 0) | 0) !== number - 0) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '请输入正确的数量'
            return
        }

        if(number > stock) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '库存不足'
            return
        }

        nextBtn.disabled = false
        nextBtn.innerHTML = '放入购物车'
    }

    numberInput.oninput = function () {
        var color = colorSelect.value
            number = this.value
            memory = memorySelect.value
            stock = goods[color + '|' + memory]
        
        numberInfo.innerHTML = number

        if (!color) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '请选择手机颜色'
            return
        }

        if (!memory) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '请选择内存大小'
            return
        }

        if(((number - 0) | 0) !== number - 0) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '请输入正确的数量'
            return
        }

        if(number > stock) {
            nextBtn.disabled = true
            nextBtn.innerHTML = '库存不足'
            return
        }

        nextBtn.disabled = false
        nextBtn.innerHTML = '放入购物车'

    }
</script>
</html>